webpackJsonp([1],{100:function(e,t){},180:function(e,t){},182:function(e,t,n){"use strict";var a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("modal",{attrs:{showModal:e.showLoginModal,closeAction:e.closeAction}},[n("h1",{attrs:{slot:"header"},slot:"header"},[e._v("Login")]),e._v(" "),n("div",{attrs:{slot:"body",id:"recaptcha-container"},slot:"body"}),e._v(" "),e.captchaPassed?n("div",{attrs:{slot:"body"},slot:"body"},[e._v("\n      Check your phone for the verification code:\n      "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.verificationCode,expression:"verificationCode"}],attrs:{placeholder:"Verification Code"},domProps:{value:e.verificationCode},on:{input:function(t){t.target.composing||(e.verificationCode=t.target.value)}}})]):n("div",{staticClass:"form-input",attrs:{slot:"body"},slot:"body"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneNumber,expression:"phoneNumber"}],attrs:{placeholder:"Phone Number"},domProps:{value:e.phoneNumber},on:{input:function(t){t.target.composing||(e.phoneNumber=t.target.value)}}})]),e._v(" "),e.captchaPassed?n("button",{attrs:{slot:"footer"},on:{click:e.verifyCode},slot:"footer"},[e._v("Submit Verification Code")]):n("button",{attrs:{slot:"footer",id:"createQueueButton"},on:{click:e.login},slot:"footer"},[e._v("Login")])])],1)},staticRenderFns:[]};t.a=a},183:function(e,t,n){"use strict";var a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),e._v(" "),n("div",{staticClass:"form"},[n("div",{staticClass:"form-inputs"},[n("div",{staticClass:"form-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{placeholder:"Queue Name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})]),e._v(" "),n("button",{attrs:{id:"createQueueButton"},on:{click:e.login}},[e._v("Create a queue")])])]),e._v(" "),n("login-modal",{attrs:{"show-modal":e.showModal},on:{"update:showModal":function(t){e.showModal=t},loggedIn:e.createQueue}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"head"},[t("h1",[this._v("Queue Now!")])])}]};t.a=a},184:function(e,t,n){"use strict";var a=n(89),i=n(186);var o=function(e){n(185)},s=n(14)(a.a,i.a,!1,o,"data-v-0f62d5e1",null);t.a=s.exports},185:function(e,t){},186:function(e,t,n){"use strict";var a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{staticClass:"head"},[t("h1",[this._v(this._s(this.name))]),this._v(" "),t("h3",[this._v("Queue Status")])]),this._v(" "),this.queueNumber?t("div",{staticClass:"queue-info"},[t("div",{staticClass:"now-serving"},[this._v("\n      Now Serving\n\n      "),t("div",{staticClass:"now-serving-box"},[t("div",{staticClass:"now-serving-number"},[this._v(this._s(this.nowServingNumber||"Nobody"))]),this._v(" "),t("div",{staticClass:"waiting-time"},[this._v("avg waiting time: "+this._s(this.waitingTimeMins)+" mins")])]),this._v(" "),t("div",{staticClass:"next"},[t("div",[this._v("Hi there, your queue number is:")]),this._v(" "),t("h2",[this._v(this._s(this.queueNumber))]),this._v(" "),t("div",{staticClass:"text-container"},[this._v("We'll contact you at "+this._s(this.phoneNumber)+" when you're almost at the front of the queue.")]),this._v(" "),t("div",{staticClass:"text-container"},[this._v("This page will automatically refresh with the latest information.")])])])]):this.notFound?t("div",[this._v("\n    Queue information not found.\n  ")]):t("div",{staticClass:"queue-info-spinner"},[t("vue-simple-spinner",{attrs:{message:"Loading...",size:"large"}})],1)])},staticRenderFns:[]};t.a=a},187:function(e,t,n){"use strict";var a=n(90),i=n(189);var o=function(e){n(188)},s=n(14)(a.a,i.a,!1,o,"data-v-05eb2f08",null);t.a=s.exports},188:function(e,t){},189:function(e,t,n){"use strict";var a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.name&&""!==e.name?n("div",{staticClass:"head"},[n("h1",[e._v(e._s(e.name))]),e._v("\n    "+e._s(e.introMessage)+"\n  ")]):e._e(),e._v(" "),e.nextNumber?n("div",{staticClass:"queue-info"},[n("div",{staticClass:"now-serving"},[e._v("\n      Now Serving\n\n      "),e.nowServingNumber?n("div",{staticClass:"now-serving-box"},[n("div",{staticClass:"now-serving-number"},[e._v(e._s(e.nowServingNumber))]),e._v(" "),n("div",{staticClass:"waiting-time"},[e._v("avg waiting time: "+e._s(e.waitingTimeMins)+" mins")])]):n("div",{staticClass:"now-serving-box"},[e._v("\n        No one in the queue now!\n      ")]),e._v(" "),n("div",{staticClass:"next"},[n("div",[e._v("Next number to be issued")]),e._v(" "),n("h3",[e._v(e._s(e.nextNumber))])]),e._v(" "),e.loggedIn?n("div",[n("button",{on:{click:e.requestNumber}},[e._v("Take a number!")]),e._v(" "),e.isOwner?n("button",{on:{click:e.advanceNumber}},[e._v("Advance number")]):e._e()]):n("button",{on:{click:e.login}},[e._v("Login to enter the queue")])])]):n("div",{staticClass:"queue-info-spinner"},[n("vue-simple-spinner",{attrs:{message:"Loading...",size:"large"}})],1),e._v(" "),n("login-modal",{attrs:{"show-modal":e.showModal},on:{"update:showModal":function(t){e.showModal=t},loggedIn:e.afterLogin}})],1)},staticRenderFns:[]};t.a=a},192:function(e,t){},31:function(e,t,n){"use strict";var a=n(20),i=n.n(a);i.a.initializeApp({}),t.a={database:i.a.database()}},47:function(e,t,n){"use strict";t.a={name:"app"}},48:function(e,t,n){"use strict";var a=n(20),i=n.n(a),o=n(31),s=n(87);t.a={data:()=>({name:"",showModal:!1}),methods:{login(){this.name&&""!==this.name?i.a.auth().currentUser?this.createQueue():this.showModal=!0:alert("Give your queue a name and provide a phone number!")},createQueue(){if(this.name&&""!==this.name){let e=i.a.auth().currentUser;if(e){let t=this.$root.$firebaseRefs.queue.push(null).key;o.a.database.ref("queueInfo/"+t).set({name:this.name,owner:e.uid,createdAt:i.a.database.ServerValue.TIMESTAMP}),this.$router.push({name:"queue",params:{qid:t}})}else this.showModal=!0}}},components:{"login-modal":s.a}}},87:function(e,t,n){"use strict";var a=n(88),i=n(182);var o=function(e){n(180)},s=n(14)(a.a,i.a,!1,o,"data-v-347251db",null);t.a=s.exports},88:function(e,t,n){"use strict";var a=n(20),i=n.n(a),o=n(181),s=n.n(o);t.a={data:function(){return{phoneNumber:null,captchaPassed:!1,verificationCode:null}},props:["showModal"],components:{Modal:s.a},methods:{closeAction(){this.$emit("update:showModal",!1)},login(){if(this.phoneNumber){let e=this;i.a.auth().signInWithPhoneNumber("+65"+this.phoneNumber,window.recaptchaVerifier).then(function(t){window.confirmationResult=t,e.captchaPassed=!0}).catch(function(e){console.log("SMS not sent"),console.log(e),window.recaptchaVerifier.render().then(function(e){window.recaptchaVerifier.reset(e)})})}else alert("Give your queue a name and provide a phone number!")},verifyCode(){if(this.verificationCode){let e=this;window.confirmationResult.confirm(e.verificationCode).then(function(t){e.closeAction(),e.$emit("loggedIn")}).catch(function(e){console.log("bad verification code?"),console.log(e)})}else alert("Ensure that you have input your verification code")}},computed:{showLoginModal:function(){return this.showModal}},mounted:function(){console.log("mounted home!"),window.recaptchaVerifier=new i.a.auth.RecaptchaVerifier("recaptcha-container",{size:"invisible",callback:function(e){console.log("calling back")}})}}},89:function(e,t,n){"use strict";var a=n(43),i=n.n(a),o=n(31);t.a={data:()=>({name:"",introMessage:"Please take a queue number.",nowServingNumber:null,queueNumber:null,phoneNumber:null,notFound:!1}),methods:{requestNumber(){this.$router.push("getNumber")}},components:{VueSimpleSpinner:i.a},created:function(){let e=this;o.a.database.ref("queue/"+this.$route.params.qid+"/"+this.$route.params.id).once("value",function(t){let n=t.val();n?(e.queueNumber=n.queueNo,e.phoneNumber=n.phoneNumber):e.notFound=!0}),o.a.database.ref("queueInfo/"+this.$route.params.qid).on("value",function(t){let n=t.val();n?(e.nowServingNumber=n.nowServing,e.name=n.name):e.notFound=!0})},computed:{waitingTimeMins:function(){if(this.queueNumber&&this.nowServingNumber){return 10*(this.queueNumber-this.nowServingNumber)}}}}},90:function(e,t,n){"use strict";var a=n(43),i=n.n(a),o=n(31),s=n(20),r=n.n(s),u=n(87);const c={userVisibleOnly:!0,applicationServerKey:function(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t);return Uint8Array.from([...n].map(e=>e.charCodeAt(0)))}("BIE6OmBhaW699gnSv4ZGvZeLGOQhhsACHOrWG0aokeZUudhve7n73lvO25S3ki2XjUl9se0Zc7Ld0LzARK2MW7Q")};t.a={data:()=>({name:"",introMessage:"Please take a queue number.",nowServingNumber:void 0,nextNumber:void 0,showModal:!1,loggedIn:!1,user:null,owner:null}),methods:{requestNumber(){function e(e){return(e||0)+1}let t=this;async function n(e,n,a){if(e&&console.error(e),n){const{pushManager:e}=await window.navigator.serviceWorker.ready,{uid:n,phoneNumber:i}=t.user;let s=await e.getSubscription();s||(s=await e.subscribe(c),o.a.database.ref(`pushSubscriptions/${n}`).set(s.toJSON()).catch(e=>console.error(e)));let u=o.a.database.ref("queue/"+t.$route.params.qid).push({phoneNumber:i,uid:n,createdAt:r.a.database.ServerValue.TIMESTAMP,queueNo:a.val()}).key;t.$router.push({name:"status",params:{qid:t.$route.params.qid,id:u}})}else console.error("Add to queue faied. Try again.")}o.a.database.ref("queueInfo/"+this.$route.params.qid+"/total").transaction(e,n)},login(){this.loggedIn||(this.showModal=!0)},afterLogin(){console.log("afterLogin")},advanceNumber(){function e(e){return(e||0)+1}function t(e,t,n){e&&console.error(e)}o.a.database.ref(`queueInfo/${this.$route.params.qid}/nowServing`).transaction(e,t)}},components:{VueSimpleSpinner:i.a,"login-modal":u.a},created:function(){let e=this;o.a.database.ref("queueInfo/"+this.$route.params.qid).on("value",function(t){let n=t.val();n?(e.name=n.name,e.nowServingNumber=n.nowServing,e.nextNumber=(n.total||0)+1,e.owner=n.owner):(e.nowServingNumber=null,e.nextNumber=1)}),r.a.auth().onAuthStateChanged(function(t){console.log("auth state changed"),t?(e.loggedIn=!0,e.user=t,console.log("user"),console.log(t)):e.loggedIn=!1})},computed:{waitingTimeMins:function(){return 10*(this.nextNumber-this.nowServingNumber)},isOwner:function(){return!(!this.user||!this.owner)&&this.user.uid===this.owner}}}},91:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(44),i=n(93),o=n(97),s=n(190),r=n.n(s),u=n(31),c=n(191),l=n(43),d=n.n(l);navigator.serviceWorker.register("/push-listener.js").then(function(e){console.log("Registration succeeded. Scope is "+e.scope),e.update()}).catch(function(e){console.log("Registration failed with "+e)}),a.a.use(c.a),a.a.use(r.a),a.a.use(d.a),a.a.config.productionTip=!1,new a.a({el:"#app",firebase:{queueInfo:u.a.database.ref("queueInfo").orderByChild("created_at"),queue:u.a.database.ref("queue").orderByChild("created_at")},router:o.a,template:"<App/>",components:{App:i.a}})},93:function(e,t,n){"use strict";var a=n(47),i=n(96);var o=function(e){n(94)},s=n(14)(a.a,i.a,!1,o,null,null);t.a=s.exports},94:function(e,t){},96:function(e,t,n){"use strict";var a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[this._m(0),this._v(" "),t("main",[t("router-view")],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("header",[t("span",[this._v("Queue Now Lah")])])}]};t.a=a},97:function(e,t,n){"use strict";var a=n(44),i=n(98),o=n(99),s=n(184),r=n(187);a.a.use(i.a),t.a=new i.a({routes:[{path:"/",name:"home",component:o.a},{path:"/queue/:qid",name:"queue",component:r.a},{path:"/queue/:qid/status/:id",name:"status",component:s.a}]})},99:function(e,t,n){"use strict";var a=n(48),i=n(183);var o=function(e){n(100)},s=n(14)(a.a,i.a,!1,o,"data-v-696444f8",null);t.a=s.exports}},[91]);